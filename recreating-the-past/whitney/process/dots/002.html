<!DOCTYPE html>
<html>
  <head>
    <title>Circle Dots</title>
  </head>
  <body style="margin: 0; overflow: hidden">
    <button id="playPause" type="button">Play</button>
    <button id="render" type="button">Render</button>
    <label>Duration <input id="duration" type="number" min="0.1" step="0.1" value="10" style="width: 60px" />s</label>
    <br />
    <input id="scrub" type="range" min="0" max="10000" value="0" step="1" style="width: 800px" />
    <br />
    <canvas id="c" width="800" height="800" style="border: 1px solid black; background: white"></canvas>
    <script type="module">
      import { wire } from "../shared/timeline.js";

      const canvas = document.getElementById("c");
      const ctx = canvas.getContext("2d");
      const $ = (id) => document.getElementById(id);

      const { tl } = wire({
        canvas,
        draw,
        deriveT: (u) => u * +document.getElementById("duration").value,
      });

      const W = 800,
        H = 800;
      const cx = W / 2,
        cy = H / 2;

      // ── parameters ──
      const N = 100; // number of dots
      const dotR = 1; // dot radius
      const ampMax = 150; // max horizontal vibration amplitude
      const freqBase = 1; // Hz for the slowest dot
      const marginY = 80; // top/bottom margin

      // ── draw ──
      function draw() {
        const t = tl.t;

        ctx.clearRect(0, 0, W, H);
        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, W, H);

        ctx.fillStyle = "black";
        for (let i = 0; i < N; i++) {
          // evenly spaced vertically
          const y = marginY + (i / (N - 1)) * (H - 2 * marginY);

          // each dot gets a higher frequency
          const freq = (i * 0.1 + 1) * freqBase;
          const amp = ampMax;
          const x = cx + amp * Math.sin(2 * Math.PI * freq * t);

          ctx.beginPath();
          ctx.arc(x, y, dotR, 0, 2 * Math.PI);
          ctx.fill();
        }
      }
    </script>
  </body>
</html>
